import{d as B,b as P,g as st,c as H,e as Xe,_ as Dt,a as Tt,k as zt}from"./@babel-DQaiFHLa.js";import{c as Te}from"./classnames-C28gIRGy.js";import{R as ft}from"./rc-resize-observer-CVw_Y2pA.js";import{t as G,u as Re,e as rt}from"./rc-util-C_kT1Pk-.js";import{r as t}from"./react-rfUEOKBT.js";import{r as nt}from"./react-dom-CWvG3IXd.js";var vt=t.forwardRef(function(e,s){var v=e.height,i=e.offsetY,d=e.offsetX,S=e.children,c=e.prefixCls,u=e.onInnerResize,M=e.innerProps,h=e.rtl,R=e.extra,a={},g={display:"flex",flexDirection:"column"};return i!==void 0&&(a={height:v,position:"relative",overflow:"hidden"},g=B(B({},g),{},P(P(P(P(P({transform:"translateY(".concat(i,"px)")},h?"marginRight":"marginLeft",-d),"position","absolute"),"left",0),"right",0),"top",0))),t.createElement("div",{style:a},t.createElement(ft,{onResize:function(m){var l=m.offsetHeight;l&&u&&u()}},t.createElement("div",st({style:g,className:Te(P({},"".concat(c,"-holder-inner"),c)),ref:s},M),S,R)))});vt.displayName="Filler";function It(e){var s=e.children,v=e.setRef,i=t.useCallback(function(d){v(d)},[]);return t.cloneElement(s,{ref:i})}function Ht(e,s,v,i,d,S,c,u){var M=u.getKey;return e.slice(s,v+1).map(function(h,R){var a=s+R,g=c(h,a,{style:{width:i},offsetX:d}),o=M(h);return t.createElement(It,{key:o,setRef:function(l){return S(h,l)}},g)})}function Ct(e,s,v){var i=e.length,d=s.length,S,c;if(i===0&&d===0)return null;i<d?(S=e,c=s):(S=s,c=e);var u={__EMPTY_ITEM__:!0};function M(m){return m!==void 0?v(m):u}for(var h=null,R=Math.abs(i-d)!==1,a=0;a<c.length;a+=1){var g=M(S[a]),o=M(c[a]);if(g!==o){h=a,R=R||g!==M(c[a+1]);break}}return h===null?null:{index:h,multiple:R}}function Pt(e,s,v){var i=t.useState(e),d=H(i,2),S=d[0],c=d[1],u=t.useState(null),M=H(u,2),h=M[0],R=M[1];return t.useEffect(function(){var a=Ct(S||[],e||[],s);(a==null?void 0:a.index)!==void 0&&R(e[a.index]),c(e)},[e]),[h]}var at=(typeof navigator>"u"?"undefined":Xe(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const dt=function(e,s,v,i){var d=t.useRef(!1),S=t.useRef(null);function c(){clearTimeout(S.current),d.current=!0,S.current=setTimeout(function(){d.current=!1},50)}var u=t.useRef({top:e,bottom:s,left:v,right:i});return u.current.top=e,u.current.bottom=s,u.current.left=v,u.current.right=i,function(M,h){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=M?h<0&&u.current.left||h>0&&u.current.right:h<0&&u.current.top||h>0&&u.current.bottom;return R&&a?(clearTimeout(S.current),d.current=!1):(!a||d.current)&&c(),!d.current&&a}};function kt(e,s,v,i,d,S,c){var u=t.useRef(0),M=t.useRef(null),h=t.useRef(null),R=t.useRef(!1),a=dt(s,v,i,d);function g(f,y){if(G.cancel(M.current),!a(!1,y)){var w=f;if(!w._virtualHandled)w._virtualHandled=!0;else return;u.current+=y,h.current=y,at||w.preventDefault(),M.current=G(function(){var k=R.current?10:1;c(u.current*k,!1),u.current=0})}}function o(f,y){c(y,!0),at||f.preventDefault()}var m=t.useRef(null),l=t.useRef(null);function E(f){if(e){G.cancel(l.current),l.current=G(function(){m.current=null},2);var y=f.deltaX,w=f.deltaY,k=f.shiftKey,N=y,x=w;(m.current==="sx"||!m.current&&k&&w&&!y)&&(N=w,x=0,m.current="sx");var O=Math.abs(N),X=Math.abs(x);m.current===null&&(m.current=S&&O>X?"x":"y"),m.current==="y"?g(f,x):o(f,N)}}function b(f){e&&(R.current=f.detail===h.current)}return[E,b]}function Nt(e,s,v,i){var d=t.useMemo(function(){return[new Map,[]]},[e,v.id,i]),S=H(d,2),c=S[0],u=S[1],M=function(R){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R,g=c.get(R),o=c.get(a);if(g===void 0||o===void 0)for(var m=e.length,l=u.length;l<m;l+=1){var E,b=e[l],f=s(b);c.set(f,l);var y=(E=v.get(f))!==null&&E!==void 0?E:i;if(u[l]=(u[l-1]||0)+y,f===R&&(g=l),f===a&&(o=l),g!==void 0&&o!==void 0)break}return{top:u[g-1]||0,bottom:u[o]}};return M}var Ot=function(){function e(){Tt(this,e),P(this,"maps",void 0),P(this,"id",0),P(this,"diffRecords",new Map),this.maps=Object.create(null)}return Dt(e,[{key:"set",value:function(v,i){this.diffRecords.set(v,this.maps[v]),this.maps[v]=i,this.id+=1}},{key:"get",value:function(v){return this.maps[v]}},{key:"resetRecord",value:function(){this.diffRecords.clear()}},{key:"getRecord",value:function(){return this.diffRecords}}]),e}();function ot(e){var s=parseFloat(e);return isNaN(s)?0:s}function $t(e,s,v){var i=t.useState(0),d=H(i,2),S=d[0],c=d[1],u=t.useRef(new Map),M=t.useRef(new Ot),h=t.useRef(0);function R(){h.current+=1}function a(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;R();var m=function(){var b=!1;u.current.forEach(function(f,y){if(f&&f.offsetParent){var w=f.offsetHeight,k=getComputedStyle(f),N=k.marginTop,x=k.marginBottom,O=ot(N),X=ot(x),V=w+O+X;M.current.get(y)!==V&&(M.current.set(y,V),b=!0)}}),b&&c(function(f){return f+1})};if(o)m();else{h.current+=1;var l=h.current;Promise.resolve().then(function(){l===h.current&&m()})}}function g(o,m){var l=e(o);u.current.get(l),m?(u.current.set(l,m),a()):u.current.delete(l)}return t.useEffect(function(){return R},[]),[g,a,M.current,S]}var it=14/15;function Bt(e,s,v){var i=t.useRef(!1),d=t.useRef(0),S=t.useRef(0),c=t.useRef(null),u=t.useRef(null),M,h=function(o){if(i.current){var m=Math.ceil(o.touches[0].pageX),l=Math.ceil(o.touches[0].pageY),E=d.current-m,b=S.current-l,f=Math.abs(E)>Math.abs(b);f?d.current=m:S.current=l;var y=v(f,f?E:b,!1,o);y&&o.preventDefault(),clearInterval(u.current),y&&(u.current=setInterval(function(){f?E*=it:b*=it;var w=Math.floor(f?E:b);(!v(f,w,!0)||Math.abs(w)<=.1)&&clearInterval(u.current)},16))}},R=function(){i.current=!1,M()},a=function(o){M(),o.touches.length===1&&!i.current&&(i.current=!0,d.current=Math.ceil(o.touches[0].pageX),S.current=Math.ceil(o.touches[0].pageY),c.current=o.target,c.current.addEventListener("touchmove",h,{passive:!1}),c.current.addEventListener("touchend",R,{passive:!0}))};M=function(){c.current&&(c.current.removeEventListener("touchmove",h),c.current.removeEventListener("touchend",R))},Re(function(){return e&&s.current.addEventListener("touchstart",a,{passive:!0}),function(){var g;(g=s.current)===null||g===void 0||g.removeEventListener("touchstart",a),M(),clearInterval(u.current)}},[e])}function ut(e){return Math.floor(Math.pow(e,.5))}function Ye(e,s){var v="touches"in e?e.touches[0]:e;return v[s?"pageX":"pageY"]-window[s?"scrollX":"scrollY"]}function Ft(e,s,v){t.useEffect(function(){var i=s.current;if(e&&i){var d=!1,S,c,u=function(){G.cancel(S)},M=function g(){u(),S=G(function(){v(c),g()})},h=function(o){if(!(o.target.draggable||o.button!==0)){var m=o;m._virtualHandled||(m._virtualHandled=!0,d=!0)}},R=function(){d=!1,u()},a=function(o){if(d){var m=Ye(o,!1),l=i.getBoundingClientRect(),E=l.top,b=l.bottom;if(m<=E){var f=E-m;c=-ut(f),M()}else if(m>=b){var y=m-b;c=ut(y),M()}else u()}};return i.addEventListener("mousedown",h),i.ownerDocument.addEventListener("mouseup",R),i.ownerDocument.addEventListener("mousemove",a),function(){i.removeEventListener("mousedown",h),i.ownerDocument.removeEventListener("mouseup",R),i.ownerDocument.removeEventListener("mousemove",a),u()}}},[e])}var Yt=10;function Xt(e,s,v,i,d,S,c,u){var M=t.useRef(),h=t.useState(null),R=H(h,2),a=R[0],g=R[1];return Re(function(){if(a&&a.times<Yt){if(!e.current){g(function(ne){return B({},ne)});return}S();var o=a.targetAlign,m=a.originAlign,l=a.index,E=a.offset,b=e.current.clientHeight,f=!1,y=o,w=null;if(b){for(var k=o||m,N=0,x=0,O=0,X=Math.min(s.length-1,l),V=0;V<=X;V+=1){var F=d(s[V]);x=N;var Q=v.get(F);O=x+(Q===void 0?i:Q),N=O}for(var j=k==="top"?E:b-E,ee=X;ee>=0;ee-=1){var te=d(s[ee]),C=v.get(te);if(C===void 0){f=!0;break}if(j-=C,j<=0)break}switch(k){case"top":w=x-E;break;case"bottom":w=O-b+E;break;default:{var re=e.current.scrollTop,$=re+b;x<re?y="top":O>$&&(y="bottom")}}w!==null&&c(w),w!==a.lastTop&&(f=!0)}f&&g(B(B({},a),{},{times:a.times+1,targetAlign:y,lastTop:w}))}},[a,e.current]),function(o){if(o==null){u();return}if(G.cancel(M.current),typeof o=="number")c(o);else if(o&&Xe(o)==="object"){var m,l=o.align;"index"in o?m=o.index:m=s.findIndex(function(f){return d(f)===o.key});var E=o.offset,b=E===void 0?0:E;g({times:0,index:m,offset:b,originAlign:l})}}}var lt=t.forwardRef(function(e,s){var v=e.prefixCls,i=e.rtl,d=e.scrollOffset,S=e.scrollRange,c=e.onStartMove,u=e.onStopMove,M=e.onScroll,h=e.horizontal,R=e.spinSize,a=e.containerSize,g=e.style,o=e.thumbStyle,m=e.showScrollBar,l=t.useState(!1),E=H(l,2),b=E[0],f=E[1],y=t.useState(null),w=H(y,2),k=w[0],N=w[1],x=t.useState(null),O=H(x,2),X=O[0],V=O[1],F=!i,Q=t.useRef(),j=t.useRef(),ee=t.useState(m),te=H(ee,2),C=te[0],re=te[1],$=t.useRef(),ne=function(){m===!0||m===!1||(clearTimeout($.current),re(!0),$.current=setTimeout(function(){re(!1)},3e3))},A=S-a||0,W=a-R||0,ae=t.useMemo(function(){if(d===0||A===0)return 0;var Y=d/A;return Y*W},[d,A,W]),D=function(T){T.stopPropagation(),T.preventDefault()},K=t.useRef({top:ae,dragging:b,pageY:k,startTop:X});K.current={top:ae,dragging:b,pageY:k,startTop:X};var ce=function(T){f(!0),N(Ye(T,h)),V(K.current.top),c(),T.stopPropagation(),T.preventDefault()};t.useEffect(function(){var Y=function(he){he.preventDefault()},T=Q.current,z=j.current;return T.addEventListener("touchstart",Y,{passive:!1}),z.addEventListener("touchstart",ce,{passive:!1}),function(){T.removeEventListener("touchstart",Y),z.removeEventListener("touchstart",ce)}},[]);var de=t.useRef();de.current=A;var pe=t.useRef();pe.current=W,t.useEffect(function(){if(b){var Y,T=function(he){var se=K.current,ze=se.dragging,Me=se.pageY,be=se.startTop;G.cancel(Y);var me=Q.current.getBoundingClientRect(),Ie=a/(h?me.width:me.height);if(ze){var q=(Ye(he,h)-Me)*Ie,fe=be;!F&&h?fe-=q:fe+=q;var Ee=de.current,ye=pe.current,He=ye?fe/ye:0,ie=Math.ceil(He*Ee);ie=Math.max(ie,0),ie=Math.min(ie,Ee),Y=G(function(){M(ie,h)})}},z=function(){f(!1),u()};return window.addEventListener("mousemove",T,{passive:!0}),window.addEventListener("touchmove",T,{passive:!0}),window.addEventListener("mouseup",z,{passive:!0}),window.addEventListener("touchend",z,{passive:!0}),function(){window.removeEventListener("mousemove",T),window.removeEventListener("touchmove",T),window.removeEventListener("mouseup",z),window.removeEventListener("touchend",z),G.cancel(Y)}}},[b]),t.useEffect(function(){return ne(),function(){clearTimeout($.current)}},[d]),t.useImperativeHandle(s,function(){return{delayHidden:ne}});var Z="".concat(v,"-scrollbar"),_={position:"absolute",visibility:C?null:"hidden"},U={position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"};return h?(_.height=8,_.left=0,_.right=0,_.bottom=0,U.height="100%",U.width=R,F?U.left=ae:U.right=ae):(_.width=8,_.top=0,_.bottom=0,F?_.right=0:_.left=0,U.width="100%",U.height=R,U.top=ae),t.createElement("div",{ref:Q,className:Te(Z,P(P(P({},"".concat(Z,"-horizontal"),h),"".concat(Z,"-vertical"),!h),"".concat(Z,"-visible"),C)),style:B(B({},_),g),onMouseDown:D,onMouseMove:ne},t.createElement("div",{ref:j,className:Te("".concat(Z,"-thumb"),P({},"".concat(Z,"-thumb-moving"),b)),style:B(B({},U),o),onMouseDown:ce}))}),Wt=20;function ct(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,v=e/s*e;return isNaN(v)&&(v=0),v=Math.max(v,Wt),Math.floor(v)}var At=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","direction","scrollWidth","component","onScroll","onVirtualScroll","onVisibleChange","innerProps","extraRender","styles","showScrollBar"],Vt=[],jt={overflowY:"auto",overflowAnchor:"none"};function Kt(e,s){var v=e.prefixCls,i=v===void 0?"rc-virtual-list":v,d=e.className,S=e.height,c=e.itemHeight,u=e.fullHeight,M=u===void 0?!0:u,h=e.style,R=e.data,a=e.children,g=e.itemKey,o=e.virtual,m=e.direction,l=e.scrollWidth,E=e.component,b=E===void 0?"div":E,f=e.onScroll,y=e.onVirtualScroll,w=e.onVisibleChange,k=e.innerProps,N=e.extraRender,x=e.styles,O=e.showScrollBar,X=O===void 0?"optional":O,V=zt(e,At),F=t.useCallback(function(n){return typeof g=="function"?g(n):n==null?void 0:n[g]},[g]),Q=$t(F),j=H(Q,4),ee=j[0],te=j[1],C=j[2],re=j[3],$=!!(o!==!1&&S&&c),ne=t.useMemo(function(){return Object.values(C.maps).reduce(function(n,r){return n+r},0)},[C.id,C.maps]),A=$&&R&&(Math.max(c*R.length,ne)>S||!!l),W=m==="rtl",ae=Te(i,P({},"".concat(i,"-rtl"),W),d),D=R||Vt,K=t.useRef(),ce=t.useRef(),de=t.useRef(),pe=t.useState(0),Z=H(pe,2),_=Z[0],U=Z[1],Y=t.useState(0),T=H(Y,2),z=T[0],oe=T[1],he=t.useState(!1),se=H(he,2),ze=se[0],Me=se[1],be=function(){Me(!0)},me=function(){Me(!1)},Ie={getKey:F};function q(n){U(function(r){var p;typeof n=="function"?p=n(r):p=n;var L=pt(p);return K.current.scrollTop=L,L})}var fe=t.useRef({start:0,end:D.length}),Ee=t.useRef(),ye=Pt(D,F),He=H(ye,1),ie=He[0];Ee.current=ie;var we=t.useMemo(function(){if(!$)return{scrollHeight:void 0,start:0,end:D.length-1,offset:void 0};if(!A){var n;return{scrollHeight:((n=ce.current)===null||n===void 0?void 0:n.offsetHeight)||0,start:0,end:D.length-1,offset:void 0}}for(var r=0,p,L,I,De=D.length,le=0;le<De;le+=1){var Be=D[le],_t=F(Be),tt=C.get(_t),Fe=r+(tt===void 0?c:tt);Fe>=_&&p===void 0&&(p=le,L=r),Fe>_+S&&I===void 0&&(I=le),r=Fe}return p===void 0&&(p=0,L=0,I=Math.ceil(S/c)),I===void 0&&(I=D.length-1),I=Math.min(I+1,D.length-1),{scrollHeight:r,start:p,end:I,offset:L}},[A,$,_,D,re,S]),ue=we.scrollHeight,ve=we.start,Se=we.end,We=we.offset;fe.current.start=ve,fe.current.end=Se,t.useLayoutEffect(function(){var n=C.getRecord();if(n.size===1){var r=Array.from(n.keys())[0],p=n.get(r),L=D[ve];if(L&&p===void 0){var I=F(L);if(I===r){var De=C.get(r),le=De-c;q(function(Be){return Be+le})}}}C.resetRecord()},[ue]);var ht=t.useState({width:0,height:S}),Ae=H(ht,2),J=Ae[0],mt=Ae[1],St=function(r){mt({width:r.offsetWidth,height:r.offsetHeight})},Ve=t.useRef(),je=t.useRef(),gt=t.useMemo(function(){return ct(J.width,l)},[J.width,l]),Rt=t.useMemo(function(){return ct(J.height,ue)},[J.height,ue]),Ce=ue-S,Pe=t.useRef(Ce);Pe.current=Ce;function pt(n){var r=n;return Number.isNaN(Pe.current)||(r=Math.min(r,Pe.current)),r=Math.max(r,0),r}var xe=_<=0,Le=_>=Ce,Ke=z<=0,Ue=z>=l,Mt=dt(xe,Le,Ke,Ue),ke=function(){return{x:W?-z:z,y:_}},Ne=t.useRef(ke()),_e=rt(function(n){if(y){var r=B(B({},ke()),n);(Ne.current.x!==r.x||Ne.current.y!==r.y)&&(y(r),Ne.current=r)}});function Ge(n,r){var p=n;r?(nt.flushSync(function(){oe(p)}),_e()):q(p)}function bt(n){var r=n.currentTarget.scrollTop;r!==_&&q(r),f==null||f(n),_e()}var Oe=function(r){var p=r,L=l?l-J.width:0;return p=Math.max(p,0),p=Math.min(p,L),p},Et=rt(function(n,r){r?(nt.flushSync(function(){oe(function(p){var L=p+(W?-n:n);return Oe(L)})}),_e()):q(function(p){var L=p+n;return L})}),yt=kt($,xe,Le,Ke,Ue,!!l,Et),Ze=H(yt,2),$e=Ze[0],qe=Ze[1];Bt($,K,function(n,r,p,L){var I=L;return Mt(n,r,p)?!1:!I||!I._virtualHandled?(I&&(I._virtualHandled=!0),$e({preventDefault:function(){},deltaX:n?r:0,deltaY:n?0:r}),!0):!1}),Ft(A,K,function(n){q(function(r){return r+n})}),Re(function(){function n(p){var L=xe&&p.detail<0,I=Le&&p.detail>0;$&&!L&&!I&&p.preventDefault()}var r=K.current;return r.addEventListener("wheel",$e,{passive:!1}),r.addEventListener("DOMMouseScroll",qe,{passive:!0}),r.addEventListener("MozMousePixelScroll",n,{passive:!1}),function(){r.removeEventListener("wheel",$e),r.removeEventListener("DOMMouseScroll",qe),r.removeEventListener("MozMousePixelScroll",n)}},[$,xe,Le]),Re(function(){if(l){var n=Oe(z);oe(n),_e({x:n})}},[J.width,l]);var Je=function(){var r,p;(r=Ve.current)===null||r===void 0||r.delayHidden(),(p=je.current)===null||p===void 0||p.delayHidden()},Qe=Xt(K,D,C,c,F,function(){return te(!0)},q,Je);t.useImperativeHandle(s,function(){return{nativeElement:de.current,getScrollInfo:ke,scrollTo:function(r){function p(L){return L&&Xe(L)==="object"&&("left"in L||"top"in L)}p(r)?(r.left!==void 0&&oe(Oe(r.left)),Qe(r.top)):Qe(r)}}}),Re(function(){if(w){var n=D.slice(ve,Se+1);w(n,D)}},[ve,Se,D]);var wt=Nt(D,F,C,c),xt=N==null?void 0:N({start:ve,end:Se,virtual:A,offsetX:z,offsetY:We,rtl:W,getSize:wt}),Lt=Ht(D,ve,Se,l,z,ee,a,Ie),ge=null;S&&(ge=B(P({},M?"height":"maxHeight",S),jt),$&&(ge.overflowY="hidden",l&&(ge.overflowX="hidden"),ze&&(ge.pointerEvents="none")));var et={};return W&&(et.dir="rtl"),t.createElement("div",st({ref:de,style:B(B({},h),{},{position:"relative"}),className:ae},et,V),t.createElement(ft,{onResize:St},t.createElement(b,{className:"".concat(i,"-holder"),style:ge,ref:K,onScroll:bt,onMouseEnter:Je},t.createElement(vt,{prefixCls:i,height:ue,offsetX:z,offsetY:We,scrollWidth:l,onInnerResize:te,ref:ce,innerProps:k,rtl:W,extra:xt},Lt))),A&&ue>S&&t.createElement(lt,{ref:Ve,prefixCls:i,scrollOffset:_,scrollRange:ue,rtl:W,onScroll:Ge,onStartMove:be,onStopMove:me,spinSize:Rt,containerSize:J.height,style:x==null?void 0:x.verticalScrollBar,thumbStyle:x==null?void 0:x.verticalScrollBarThumb,showScrollBar:X}),A&&l>J.width&&t.createElement(lt,{ref:je,prefixCls:i,scrollOffset:z,scrollRange:l,rtl:W,onScroll:Ge,onStartMove:be,onStopMove:me,spinSize:gt,containerSize:J.width,horizontal:!0,style:x==null?void 0:x.horizontalScrollBar,thumbStyle:x==null?void 0:x.horizontalScrollBarThumb,showScrollBar:X}))}var Ut=t.forwardRef(Kt);Ut.displayName="List";export{Ut as L};
//# sourceMappingURL=rc-virtual-list-Qta6jkBc.js.map
