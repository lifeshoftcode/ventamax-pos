import{j as r,r as f}from"./react-rfUEOKBT.js";import{D}from"./luxon-BWY9yW-5.js";import{q as I}from"./styled-components-BzLUfkZ7.js";import{d as E,u as C,T as w,g as F,s as M,a as N,S as H,I as R,i as y,b as k,D as d,c as B,o as L,e as G,f as O,h as U,A as q}from"./index-rUC063_I.js";import{F as z,aO as V}from"./fortawesome-bundle-DmAwtW_I.js";import{l as _}from"./react-to-print-F63qNxNA.js";import{a as $,u as g}from"./react-redux-BpD1u4T_.js";import{h as J,t as K}from"./firebase-Bi7PrE1-.js";import{B as x,s as b}from"./antd-j42DH-28.js";import"./@sentry-C9RpjZZ5.js";import"./hoist-non-react-statics-DzxTubvU.js";import"./react-is-CkhetEIG.js";import"./shallowequal-DAPzeuxg.js";import"./@emotion-CJOp8bw3.js";import"./react-dom-CWvG3IXd.js";import"./scheduler-C323NY8X.js";import"./react-router-dom-I0lnFv1F.js";import"./react-router-d3h5byfE.js";import"./@remix-run-DFS2GQke.js";import"./@reduxjs-TYVnLVsu.js";import"./immer-C0GRqQ_d.js";import"./redux-Pkr-OV8C.js";import"./@babel-DQaiFHLa.js";import"./redux-thunk-CY0Q9z1Q.js";import"./dayjs-DQ_OJjfb.js";import"./framer-motion-BahAblW5.js";import"./@ant-design-BOJYnYvx.js";import"./rc-util-C_kT1Pk-.js";import"./throttle-debounce-CUWDS_la.js";import"./classnames-C28gIRGy.js";import"./resize-observer-polyfill-BlcKtro_.js";import"./json2mq-C8mWzkA0.js";import"./string-convert-Bhuo--sE.js";import"./react-popper-DWMYTNqV.js";import"./@popperjs-CMBiYTiD.js";import"./nanoid-OxPLOBIU.js";import"./yet-another-react-lightbox-CU6vqjhs.js";import"./@supabase-kpI-vHkG.js";import"./react-helmet-async-mH61wGUr.js";import"./invariant-BDCZZhhA.js";import"./lodash-Bii6Cmo5.js";import"./libphonenumber-js-BjFIu9YR.js";import"./country-flag-icons-ZZ6o7arK.js";import"./react-zoom-pan-pinch-BsIRrnk0.js";import"./@tanstack-ku59xrFY.js";import"./react-barcode-DYUTUow9.js";import"./jsbarcode-CCImmBHL.js";import"./prop-types-DRkc8p4u.js";import"./html2canvas-DadlvMMh.js";import"./jspdf-DA_NNWqC.js";import"./fflate-DRMPHaEN.js";import"./bcryptjs-UwuLHmlE.js";import"./@casl-Dm1p89cb.js";import"./@ucast-BZ_ondnv.js";import"./print-js-BNOJORLg.js";import"./pdfmake-W4Ssq9oK.js";import"./react-chartjs-2-BhKEQuOQ.js";import"./chart.js-B2VU77fl.js";import"./@kurkle-BZxJdD1U.js";import"./lightweight-charts-BFv_P73W.js";import"./fancy-canvas-DqIfKA7H.js";import"./exceljs-DADyeoF6.js";import"./react-markdown-D54YYYhm.js";import"./property-information-CLgGhD1-.js";import"./unist-util-visit-SwKB2sUE.js";import"./unist-util-visit-parents-MnEmTlHn.js";import"./unist-util-is-DiTsIWAy.js";import"./hast-util-whitespace-D1ONPEmv.js";import"./space-separated-tokens-DD3iYX1K.js";import"./comma-separated-tokens-xMQ5YY98.js";import"./style-to-object-DB6SD-wt.js";import"./inline-style-parser-D4u_cg7q.js";import"./unified-Be3qCFGf.js";import"./bail-FqpXQuLt.js";import"./is-buffer-DR4WRMs3.js";import"./extend-DyvUZfS1.js";import"./is-plain-obj-C1gvLhAf.js";import"./trough-BLo6HeTa.js";import"./vfile-DXaTyxVO.js";import"./vfile-message-BOGBuebs.js";import"./unist-util-stringify-position-Ch_qCilz.js";import"./remark-parse-CQxuRO-h.js";import"./mdast-util-from-markdown-CLAsVoWb.js";import"./micromark-CTBPIv-_.js";import"./micromark-util-combine-extensions-Bka6Sc1c.js";import"./micromark-util-chunked-DrRIdSP-.js";import"./micromark-factory-space-x2vfxbz5.js";import"./micromark-util-character-Bcm1tP9o.js";import"./micromark-core-commonmark-AH8VCgT7.js";import"./micromark-util-classify-character-Cq7Fg3xE.js";import"./micromark-util-resolve-all-PQCKh0dx.js";import"./decode-named-character-reference-C3-224fz.js";import"./micromark-util-subtokenize-QwsxNXk2.js";import"./micromark-factory-destination-CypD_wgM.js";import"./micromark-factory-label-CRHH4ZHP.js";import"./micromark-factory-title-B7kCBvC9.js";import"./micromark-factory-whitespace-B322EA6O.js";import"./micromark-util-normalize-identifier-C9ANKk3v.js";import"./micromark-util-html-tag-name-DbKNfynz.js";import"./micromark-util-decode-numeric-character-reference-DRnCnno4.js";import"./micromark-util-decode-string-DJl8Y_PO.js";import"./mdast-util-to-string-C_aolqmU.js";import"./remark-rehype-BJ4RwZvz.js";import"./mdast-util-to-hast-Dxh8Xa5R.js";import"./micromark-util-sanitize-uri-nvkIJkgW.js";import"./unist-util-position-KiAvrw8y.js";import"./trim-lines-D8znQY54.js";import"./mdast-util-definitions-CfSXY7bG.js";import"./unist-util-generated-CMz5gPdA.js";import"./react-resizable-Dks54vAc.js";import"./react-draggable-tQ-U4Cs0.js";import"./clsx-DZfZ8_xD.js";import"./browser-image-compression-BgY3rL5_.js";import"./draft-js-DAs_DQPn.js";import"./immutable-DXvhHeRx.js";import"./fbjs-DyKbDm8H.js";import"./ua-parser-js-D66YbI_D.js";import"./setimmediate-Iuu2flFm.js";import"./object-assign-Dw8nQtKq.js";import"./gsap-THuJE7GK.js";import"./@gsap-BvwWf4K0.js";import"./i18next-CWBR8qAX.js";import"./react-i18next-BuNVbWF_.js";import"./tslib-DMafyLhP.js";import"./idb-BXWtuYvb.js";import"./use-sync-external-store-Crb5SR0Q.js";import"./rc-resize-observer-CVw_Y2pA.js";import"./rc-pagination-KA8P55Kf.js";import"./rc-picker-DH5JTmAh.js";import"./rc-motion-F1MUgz2i.js";import"./@rc-component-DxyG_Y2B.js";import"./rc-overflow-CaWLhvk3.js";import"./scroll-into-view-if-needed-DzP2pgWD.js";import"./compute-scroll-into-view-DX-5lRff.js";import"./rc-notification-D74cTc8r.js";import"./rc-collapse-BI4JetZt.js";import"./rc-dialog-fBSOMSMf.js";import"./rc-field-form-BUHLZMO7.js";import"./rc-select-DqdyuVBS.js";import"./rc-virtual-list-Qta6jkBc.js";import"./rc-tooltip-CG8TVdPc.js";import"./rc-dropdown-CtvU_cpG.js";import"./rc-menu-DuuJLGul.js";import"./rc-checkbox-BWD1hXIW.js";import"./rc-tabs-Cr99MSui.js";import"./rc-cascader-BLh4hl1a.js";import"./rc-tree-iXRYS6u9.js";import"./rc-segmented-BKWhqiCO.js";import"./rc-input-number-C8RExCFJ.js";import"./rc-input-BrplG3Px.js";import"./rc-slider-Cxg2mE7Z.js";import"./rc-drawer-CImWsfBY.js";import"./rc-image-DZmcFfgd.js";import"./rc-textarea-TypTsaWD.js";import"./rc-mentions-B3qlsLWL.js";import"./rc-progress-CqcvTdp4.js";import"./rc-rate-BgFFP8Cu.js";import"./rc-steps-DaZHkSYD.js";import"./rc-switch-BwrdY8B1.js";import"./rc-table-CTaRmOEq.js";import"./rc-tree-select-BHlP8Nzj.js";import"./copy-to-clipboard-U8AMuClB.js";import"./toggle-selection-DGa8lynz.js";import"./rc-upload-BFAmo5YR.js";const Q=async(i,e,o)=>{const p=J(E,"businesses",i==null?void 0:i.businessID,"cashCounts",e),t=await K(p);return t.exists()&&e&&o?t.data().cashCount.state===o:!1},X=({value:i})=>{var T;const e=$(),o=i.data,p=g(M),t=g(N)||{},m=f.useRef(null),[s,n]=f.useState(!1),a=((T=o==null?void 0:o.date)==null?void 0:T.seconds)<Date.now()/1e3-172800,u=g(H).billing.invoiceType;f.useEffect(()=>{(async()=>{if(p&&o&&typeof o.cashCountId<"u"&&o.cashCountId!==null)try{const l=await Q(p,o.cashCountId,"open");n(!l&&a)}catch{n(!0)}else n(!0)})()},[p,o==null?void 0:o.cashCountId]);const P=()=>{var l,v;const c={...o,date:d.convertTimestampToMillis(o.date),payWith:(l=o==null?void 0:o.paymentMethod.find(j=>j.status===!0))==null?void 0:l.value,updateAt:d.convertTimestampToMillis(o==null?void 0:o.updateAt),cancel:o!=null&&o.cancel?{...o.cancel,cancelledAt:d.convertTimestampToMillis((v=o==null?void 0:o.cancel)==null?void 0:v.cancelledAt)}:null};e(B({invoice:c}))},A=_.useReactToPrint({content:()=>m.current}),S=async()=>{if(u==="template2")try{await k(t,o,()=>{b.success({message:"PDF Generado",description:"El PDF ha sido generado exitosamente",duration:4})})}catch(c){b.error({message:"Error al imprimir",description:`No se pudo generar el PDF: ${c.message}`,duration:4}),console.error("❌ PDF generation failed:",c),console.error("❌ Error stack:",c.stack)}else A()},W=()=>{e(L(o))};return r.jsxs("div",{style:{display:"flex",gap:"10px"},children:[r.jsx(R,{ref:m,data:o}),r.jsx(x,{icon:r.jsx(z,{icon:V}),onClick:S}),r.jsx(x,{icon:y.editingActions.edit,onClick:P,disabled:s}),r.jsx(x,{icon:y.editingActions.show,onClick:W})]})},Y=[{Header:"N°",accessor:"numberID",sortable:!0,align:"left",maxWidth:"0.4fr",min:"120px"},{Header:"RNC",accessor:"ncf",sortable:!0,align:"left",maxWidth:"1.4fr",min:"150px",cell:({value:i})=>i?r.jsx("div",{children:i}):r.jsx(w,{children:"No Disponible"})},{Header:"Cliente",accessor:"client",sortable:!0,align:"left",maxWidth:"1.6fr",minWidth:"170px"},{Header:"Fecha",accessor:"date",sortable:!0,align:"left",cell:({value:i})=>{const e=i*1e3;return F(e,0)},maxWidth:"1fr",minWidth:"160px"},{Header:"ITBIS",accessor:"itbis",align:"right",cell:({value:i})=>C(i),maxWidth:"1fr",minWidth:"100px"},{Header:"Articulos",accessor:"products",align:"right",description:"Articulos comprados",maxWidth:"1fr",minWidth:"100px"},{Header:"Total",accessor:"total",align:"right",cell:({value:i})=>C(i),description:"Monto total de la compra",maxWidth:"1fr",minWidth:"110px"},{Header:"Acción",align:"right",accessor:"accion",description:"Accion",maxWidth:"1fr",minWidth:"80px",cell:({value:i})=>r.jsx(X,{value:i})}],rr=({bills:i=[],searchTerm:e})=>{const o=i==null?void 0:i.map(({data:t})=>{var s,n,a,h,u;const m=t==null?void 0:t.NCF;return{numberID:t==null?void 0:t.numberID,ncf:t==null?void 0:t.NCF,client:((s=t==null?void 0:t.client)==null?void 0:s.name)||"Generic Client",date:(n=t==null?void 0:t.date)==null?void 0:n.seconds,itbis:U(t==null?void 0:t.products),payment:(a=t==null?void 0:t.payment)==null?void 0:a.value,products:O(t==null?void 0:t.products),change:(h=t==null?void 0:t.change)==null?void 0:h.value,total:G(t==null?void 0:t.products,0,0,m),ver:{data:t},accion:{data:t},dateGroup:D.fromMillis(((u=t==null?void 0:t.date)==null?void 0:u.seconds)*1e3).toLocaleString(D.DATE_FULL)}}),p=f.useMemo(()=>C(i.reduce((t,{data:m})=>{var s;return t+Number(((s=m==null?void 0:m.totalPurchase)==null?void 0:s.value)||0)},0)),[i]);return r.jsx(q,{columns:Y,data:o,groupBy:"dateGroup",emptyText:"No se encontraron facturas para la fecha seleccionada. Realice ventas y aparecerán en esta sección",footerLeftSide:r.jsxs(Z,{children:["Total: ",p," "]}),searchTerm:e,elementName:"facturas",tableName:"Facturas",numberOfElementsPerPage:40})},Z=I.div`
  display: flex;
  justify-content: flex-end;
  align-items: center;
  padding: 0.2em 0.5em;
  gap: 0.5em;
  font-size: 1em;
  font-weight: 600;
`;I.div`
  
  display: flex;
  overflow: hidden;
`;export{rr as default};
//# sourceMappingURL=SaleReportTable-BqR42KvU.js.map
